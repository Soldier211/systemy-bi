from sklearn.tree import DecisionTreeClassifier
from sklearn.neighbors import KNeighborsClassifier
from sklearn.metrics import accuracy_score, recall_score, confusion_matrix, roc_auc_score

# Drzewo decyzyjne
dt = DecisionTreeClassifier(random_state=42)
dt.fit(X_train, y_train)
y_pred_dt = dt.predict(X_val)
y_proba_dt = dt.predict_proba(X_val)[:,1]

# KNN
knn = KNeighborsClassifier()
knn.fit(X_train, y_train)
y_pred_knn = knn.predict(X_val)
y_proba_knn = knn.predict_proba(X_val)[:,1]

# Funkcja do obliczania specyficzności
def specificity(y_true, y_pred):
    tn, fp, fn, tp = confusion_matrix(y_true, y_pred).ravel()
    return tn / (tn + fp)

# Wyniki dla drzewa
print("Drzewo decyzyjne:")
print("Accuracy:", accuracy_score(y_val, y_pred_dt))
print("Recall (czułość):", recall_score(y_val, y_pred_dt))
print("Specificity (specyficzność):", specificity(y_val, y_pred_dt))
print("AUC:", roc_auc_score(y_val, y_proba_dt))

# Wyniki dla KNN
print("\nKNN:")
print("Accuracy:", accuracy_score(y_val, y_pred_knn))
print("Recall (czułość):", recall_score(y_val, y_pred_knn))
print("Specificity (specyficzność):", specificity(y_val, y_pred_knn))
print("AUC:", roc_auc_score(y_val, y_proba_knn))